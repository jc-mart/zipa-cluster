- name: "Copying SMB share credentials for NAS mounting"
  copy:
    src: .smb_credentials # Assumes file exists in client/files directory
    dest: /home/pi

- name: "Creating NAS directory"
  file:
    path: /mnt/testbed-data # Change if necessary
    state: directory
    owner: pi
    mode: '0755'

- name: "Mounting to NAS"
  mount:
    backup: true
    boot: true
    fstype: cifs
    path: /mnt/testbed-data
    src: "{{ nas }}"
    dump: '0'
    opts: "credentials=/home/pi/.smb_credentials,file_mode=0755,dir_mode=0755,user" # TODO create this file
    state: mounted
